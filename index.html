<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Variant Search Tool</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <style>
            .grid-header {
                background-color:lightskyblue;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }
            
            .title-element {
                margin: 3px;
                padding: 3px;
                background-color: aliceblue;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                font-size: 20px;
            }

            .grid-body {
                background-color: aliceblue;
            }

            div {
                padding: 2px;
            }

            .col-container {
                padding: 0px;
                text-align: center;
            }

            .col-highlight {
                background-color: lightslategrey;
            }
        </style>
    </head>
    <body>
        <script>
            (function() {
                const port = 3000;
                const url = `http://localhost:${port}`;
                
                function setUpDocument() {
                    loadAllRows();
                    //addHighlightListeners();
                }
                
                function addHighlightListeners() {
                    let columns = [
                        'gene-col',
                        'nucleotide-col',
                        'protein-col',
                        'alias-col',
                        'region-col',
                        'classification-col',
                        'eval-col',
                        'update-col',
                        'info-col'
                    ]
                    columns.forEach(col => {
                        document.getElementById(col).addEventListener('mouseover', function() {
                            this.classList.add('col-highlight');
                        });
                    });
                }
                
                function loadAllRows() {
                    let xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = () => {
                        if (xhttp.readyState === 4 && xhttp.status === 200) {
                            addData(xhttp.responseText);
                        }
                    }
                    let endpoint = url + '/genes/all';
                    xhttp.open('GET', endpoint, true);
                    xhttp.send();
                }

                function addData(responseText) {
                    let columns = {
                        'gene-col': 'gene',
                        'nucleotide-col': 'nucleotide_change',
                        'protein-col': 'protein_change',
                        'alias-col': 'alias',
                        'region-col': 'region',
                        'classification-col': 'reported_classification',
                        'eval-col': 'last_evaluated',
                        'update-col': 'last_updated',
                        'info-col': 'source'
                    };

                    responseBody = JSON.parse(responseText);
                    let rows = responseBody['results'];
                    for (let i = 0; i < rows.length; i++) {
                        for (let col in columns) {
                            let element = document.getElementById(col);
                            if (i % 2 == 0) {
                                element.innerHTML += `<div class="grid-body" style="padding: 0px;">${rows[i][columns[col]]}</div>`;
                            }
                            else {
                                element.innerHTML += `<div style="padding: 0px;">${rows[i][columns[col]]}</div>`;
                            }
                        }
                    }
                }
                document.addEventListener('DOMContentLoaded', setUpDocument);
            })();
        </script>
        <div class="d-flex flex-column">
            <div id="title" class="title-element">Variant Search Tool</div>
            <div class="d-flex flex-row">
                <div class="d-inline-flex flex-row mr-auto">
                    <div class="input-group input-group-sm">
                        <input type="text" placeholder="Enter a gene name" style="text-align: center;">
                        <button class="btn btn-sm mx-1 btn-primary">Search</button>
                        <button class="btn button-sm btn-secondary">Clear</button>
                    </div>
                </div>
                <div class="d-inline-flex flex-row">
                    <button class="btn btn-sm btn-outline-secondary"><i class="fa fa-angle-double-left"></i></button>
                    <button class="btn btn-sm btn-outline-secondary"><i class="fa fa-angle-double-right"></i></button>
                </div>
                <!-- Insert markup for pagination here-->
            </div>
            <div class="d-flex flex-row" style="overflow: auto;">
                <div class="d-flex flex-column col-container" style="min-width: 10%">
                    <div class="grid-header">Gene</div>
                    <div id="gene-col" style="padding: 0px"></div>
                </div>
                <div class="d-flex flex-column col-container" style="min-width: 40%;">
                    <div class="grid-header">Nucleotide Change</div>
                    <div id="nucleotide-col" style="padding: 0px"></div>
                </div>
                <div class="d-flex flex-column col-container" style="min-width: 20%;">
                    <div class="grid-header">Protein Change</div>
                    <div id="protein-col" style="padding: 0px"></div>
                </div>
                <div class="d-flex flex-column col-container" style="min-width: 15%;">
                    <div class="grid-header">Alias</div>
                    <div id="alias-col" style="padding: 0px"></div>
                </div>
                <div class="d-flex flex-column col-container" style="min-width: 17%;">
                    <div class="grid-header">Region</div>
                    <div id="region-col" style="padding: 0px"></div>
                </div>
                <div class="d-flex flex-column col-container" style="min-width: 15%;">
                    <div class="grid-header">Reported Classification</div>
                    <div id="classification-col" style="padding: 0px"></div>
                </div>
                <div class="d-flex flex-column col-container" style="min-width: 10%">
                        <div class="grid-header">Last Evaluated</div>
                        <div id="eval-col" style="padding: 0px"></div>
                </div>
                <div class="d-flex flex-column col-container" style="min-width: 10%;">
                    <div class="grid-header">Last Updated</div>
                    <div id="update-col" style="padding: 0px"></div>
                </div>
                <div class="d-flex flex-column col-container" style="min-width: 8%;">
                    <div class="grid-header">More Info</div>
                    <div id="info-col" style="padding: 0px"></div>
                </div>
            </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    </body>
</html>